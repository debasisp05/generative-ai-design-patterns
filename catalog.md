| Category            | Pattern Name           | Problem                                                                                                                                      | Best Practice Solution                                                                                                                                                                                                         | Reference                                                                                                                                         | Tradeoffs and Alternatives                                                                                                                                                                                                                                                                                                                                                                                                                             | Example demonstrating usage                                                                           |
|---------------------|------------------------|----------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------|
| Controlling Style   | Grammar                | LLM needs to generate text that follows a strict grammar. This could be as simple as JSON, XML, etc. or as complex as a chess game notation. | Express constraints in Backus-Naur Form (BNF), and augment demonstration examples with the grammar.                                                                                                                            | https://arxiv.org/abs/2305.19234  https://github.com/ggerganov/llama.cpp/blob/master/grammars/README.md                                           | Providing just examples is inconsistent, and fails more frequently  For simple tasks, possible to use a template approach                                                                                                                                                                                                                                                                                                                              | https://til.simonwillison.net/llms/llama-cpp-python-grammars  https://github.com/ejones/llama-journey |
|                     | Self Check             | Get an LLM to say "I don't know" rather than hallucinating facts or details.                                                                 | Get an LLM to generate multiple answers in parallel. Do a self-consistency check, and if they diverge, it's probably hallucinating.                                                                                            | https://arxiv.org/abs/2303.08896                                                                                                                  | Fine-tuning the LLM or using examples for which "I don't know" is the right answer is less reliable.                                                                                                                                                                                                                                                                                                                                                   | Use output rails in NeMo-Guardrails: https://github.com/NVIDIA/NeMo-Guardrails                        |
|                     | Reverse Neutralization | LLM needs to match a specific tone and voice, such as your company style or personal style.                                                  | Take content created in desired style, ask LLM to rephrase in neutral language at 10th grade level. Reverse the inputs and outputs and use it to fine-tune a model that will take LLM outputs and rephrase them in your style. | https://community.openai.com/t/train-a-gpt-model-in-my-tone/119175/31  https://arxiv.org/abs/2308.07968  https://github.com/technicalwriting/hank | It's hard to create a dataset that covers all possible topics, so using only a fine-tuned LLM tends to lose of creativity.  If all you need is a style checker, you can use an off-the-shelf LLM to enforce a style guide.  If your content does cover all possible topics, you can create a RAG and fine-tune every stage of it (see: https://arxiv.org/abs/2308.07968)  If the matching is in terms of instructions, use the Style Transfer pattern. |                                                                                                       |
|                     | Style Transfer         | Get an LLM to follow instructions such as "more positive" but get the right level of positivity.                                             | Use augmented zero-shot prompting, which augments what's desired with variations that are non-exemplars.                                                                                                                       | https://aclanthology.org/2022.acl-short.94.pdf                                                                                                    | See Reverse Neutralization                                                                                                                                                                                                                                                                                                                                                                                                                             |                                                                                                       |
| Controlling Task    | Adapter Tuning         |                                                                                                                                              |                                                                                                                                                                                                                                |                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                        |                                                                                                       |
|                     | Instruction Tuning     |                                                                                                                                              |                                                                                                                                                                                                                                |                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                        |                                                                                                       |
|                     | Few Shot               |                                                                                                                                              |                                                                                                                                                                                                                                |                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                        |                                                                                                       |
|                     | Chain of Thought       |                                                                                                                                              |                                                                                                                                                                                                                                |                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                        |                                                                                                       |
| Architectural       | Agents                 |                                                                                                                                              |                                                                                                                                                                                                                                |                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                        |                                                                                                       |
|                     | RAG                    |                                                                                                                                              |                                                                                                                                                                                                                                |                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                        |                                                                                                       |
|                     | Tools                  |                                                                                                                                              |                                                                                                                                                                                                                                |                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                        |                                                                                                       |
|                     | Prompt Tuning          |                                                                                                                                              |                                                                                                                                                                                                                                |                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                        |                                                                                                       |
|                     | Guardrails             |                                                                                                                                              |                                                                                                                                                                                                                                |                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                        |                                                                                                       |
| Controlling Context | Example Selection      |                                                                                                                                              |                                                                                                                                                                                                                                |                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                        |                                                                                                       |
